{"version":3,"file":"laravel-vapor.mjs","sources":["../src/index.js"],"sourcesContent":["const axios = require('axios')\nconst CancelToken = axios.CancelToken\n\nclass Vapor\n{\n    constructor() {\n        this.cancelAction = null\n    }\n\n    /**\n     * Store a file in S3 and return its UUID, key, and other information.\n     */\n    async store(file, options = {}) {\n        const response = await axios.post('/vapor/signed-storage-url', {\n            'bucket': options.bucket || '',\n            'content_type': options.contentType || file.type,\n            'expires': options.expires || '',\n            'visibility': options.visibility || ''\n        }, {\n            baseURL: options.baseURL || null,\n            headers: options.headers || {}\n        });\n\n        let headers = response.data.headers;\n\n        if ('Host' in headers) {\n            delete headers.Host;\n        }\n\n        if (typeof options.progress === 'undefined') {\n            options.progress = () => {};\n        }\n\n        const cancelToken = new CancelToken(cancel => {\n            this.cancelAction = cancel\n        })\n\n        await axios.put(response.data.url, file, {\n            cancelToken: cancelToken,\n            headers: headers,\n            onUploadProgress: (progressEvent) => {\n                options.progress(progressEvent.loaded / progressEvent.total);\n            }\n        });\n\n        response.data.extension = file.name.split('.').pop()\n\n        return response.data;\n    }\n\n    cancel() {\n        if (this.cancelAction) {\n            this.cancelAction()\n            this.cancelAction = null\n        }\n    }\n}\n\nmodule.exports = new Vapor();\n"],"names":["const","axios","require","CancelToken","Vapor","constructor","cancelAction","store","file","options","this","post","bucket","contentType","type","expires","visibility","baseURL","headers","response","data","Host","progress","cancelToken","cancel","put","url","onUploadProgress","progressEvent","loaded","total","extension","name","split","pop","module","exports"],"mappings":"AAAAA,IAAMC,EAAQC,QAAQ,SAChBC,EAAcF,EAAME,YAEpBC,EAEFC,gBACSC,aAAe,MAMlBC,YAAAA,eAAMC,EAAMC,kBAAU,cAsBpBC,4BArBmBT,EAAMU,KAAK,4BAA6B,QACjDF,EAAQG,QAAU,gBACZH,EAAQI,aAAeL,EAAKM,aACjCL,EAAQM,SAAW,cAChBN,EAAQO,YAAc,IACrC,CACCC,QAASR,EAAQQ,SAAW,KAC5BC,QAAST,EAAQS,SAAW,oBAP1BC,OAUFD,EAAUC,EAASC,KAAKF,QAExB,SAAUA,UACHA,EAAQG,UAGa,IAArBZ,EAAQa,WACfb,EAAQa,2BAGNC,EAAc,IAAIpB,WAAYqB,KAC3BlB,aAAekB,2BAGlBvB,EAAMwB,IAAIN,EAASC,KAAKM,IAAKlB,EAAM,aACxBe,UACJL,EACTS,0BAAmBC,GACfnB,EAAQa,SAASM,EAAcC,OAASD,EAAcE,kCAI9DX,EAASC,KAAKW,UAAYvB,EAAKwB,KAAKC,MAAM,KAAKC,MAExCf,EAASC,6CAGpBI,YAAAA,kBACQd,KAAKJ,oBACAA,oBACAA,aAAe,OAKhC6B,OAAOC,QAAU,IAAIhC"}